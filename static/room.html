<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wire Â· Create or Join Room</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg-main: #020617;
      --bg-card: #020617;
      --border: #1e293b;
      --text-primary: #f8fafc;
      --text-muted: #94a3b8;
      --accent: #38bdf8;
      --accent-hover: #0ea5e9;
      --danger: #ef4444;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background:
        radial-gradient(800px 400px at top right, #020617, transparent),
        radial-gradient(600px 300px at bottom left, #020617, transparent),
        var(--bg-main);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-primary);
    }

    .card {
      width: 100%;
      max-width: 420px;
      background: linear-gradient(
        180deg,
        rgba(2,6,23,0.85),
        rgba(2,6,23,1)
      );
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 28px;
      box-shadow:
        0 20px 40px rgba(0,0,0,0.6),
        inset 0 1px 0 rgba(255,255,255,0.04);
    }

    .header {
      margin-bottom: 24px;
    }

    .header h1 {
      font-size: 22px;
      font-weight: 600;
      letter-spacing: -0.3px;
      margin-bottom: 6px;
    }

    .header p {
      font-size: 14px;
      color: var(--text-muted);
    }

    .section {
      margin-bottom: 22px;
    }

    .label {
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 6px;
      display: block;
      color: var(--text-muted);
    }

    input {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text-primary);
      font-size: 14px;
      transition: border-color 0.15s, box-shadow 0.15s;
    }

    input::placeholder {
      color: #64748b;
    }

    input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(56,189,248,0.2);
    }

    .divider {
      height: 1px;
      background: var(--border);
      margin: 22px 0;
    }

    .actions {
      display: flex;
      gap: 12px;
      flex-direction: column;
    }

    button {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(
        180deg,
        rgba(56,189,248,0.15),
        rgba(56,189,248,0.05)
      );
      color: var(--text-primary);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: transform 0.08s ease, background 0.15s, border-color 0.15s;
    }

    button:hover {
      border-color: var(--accent);
      background: linear-gradient(
        180deg,
        rgba(56,189,248,0.25),
        rgba(56,189,248,0.1)
      );
    }

    button:active {
      transform: scale(0.98);
    }

    .hint {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 6px;
    }

    footer {
      margin-top: 22px;
      text-align: center;
      font-size: 12px;
      color: #64748b;
    }

    @media (max-width: 480px) {
      .card {
        padding: 22px;
        border-radius: 12px;
      }
    }
  </style>
</head>

<body>

  <div class="card">

    <div class="header">
      <h1>Wire</h1>
      <p>Create or join a secure real-time chat room</p>
    </div>

    <!-- Username -->
    <div class="section">
      <label class="label">Username</label>
      <input id="username" placeholder="Your display name" />
      <div class="hint">Visible to everyone in the room</div>
    </div>

    <div class="divider"></div>

    <!-- Create Room -->
    <div class="section">
      <button onclick="createRoom()">Create New Room</button>
    </div>

    <div class="divider"></div>

    <!-- Join Room -->
    <div class="section">
      <label class="label">Room ID</label>
      <input id="roomId" placeholder="6-digit room code" />
      <div class="hint">Example: 482193</div>
    </div>

    <div class="actions">
      <button onclick="joinRoom()">Join Existing Room</button>
    </div>

    <footer>
      End-to-end realtime messaging
    </footer>

  </div>

<script>
function getUsername() {
  const usernameInput = document.getElementById("username");
  if (!usernameInput) {
    alert("Username input not found");
    return null;
  }

  const username = usernameInput.value.trim();
  if (!username) {
    alert("Username is required");
    return null;
  }

  return username;
}

function createRoom() {
  const username = getUsername();
  if (!username) return;

  fetch("/create-room")
    .then(res => {
      if (!res.ok) throw new Error("Failed to create room");
      return res.json();
    })
    .then(data => {
      window.location.href =
        `/static/room.html?room=${data.room_id}&username=${encodeURIComponent(username)}`;
    })
    .catch(err => console.log("Create room error:", err));
}

function joinRoom() {
  const username = getUsername();
  const roomIdInput = document.getElementById("roomId");

  if (!roomIdInput) {
    alert("Room ID input not found");
    return;
  }

  const roomId = roomIdInput.value.trim();

  if (!username) return;

  if (!/^\d{6}$/.test(roomId)) {
    alert("Room ID must be exactly 6 digits");
    return;
  }

  window.location.href =
    `/static/room.html?room=${roomId}&username=${encodeURIComponent(username)}`;
}
</script>

</body>
</html>
